sap.ui.define(["com/eramet/maintenanceF5D/controller/BaseController","com/eramet/maintenanceF5D/util/util","com/eramet/maintenanceF5D/util/formatter"],function(e,t,i){"use strict";return e.extend("com.eramet.depanneur.HATDepanneurApp.controller.Detail",{onInit:function(){this.getRouter().attachRoutePatternMatched(this._onRouteMatched,this)},_onRouteMatched:function(e){if(e.getParameter("name")==="Detail"){var i=t.sSelectedTile.split("--")[1],s="",n="";n=this.getView().getModel("i18n").getResourceBundle().getText("avisTitle");this._resetModel();this.getView().byId("detail").setTitle(n)}},_resetModel:function(){var e=[{title:"N° avis 0001",text:"Tube qui fuit",date:"21/10/2019",equipement:"Trousse de réparation",status:"Faible"},{title:"N° avis 0002",text:"Verre brisé",date:"18/10/2019",equipement:"Verre coupé à la taille",status:"Moyenne"},{title:"N° avis 0003",text:"Plateau cassé",date:"17/10/2019",equipement:"Charpentier",status:"Majeure"},{title:"N° avis 0004",text:"Pas de chauffage",date:"21/10/2019",equipement:"Mécanicien en chauffage",status:"Faible"},{title:"N° avis 0005",text:"Casier cassé",date:"15/10/2019",equipement:"Serrurier",status:"Majeure"}];t.aElements=e;this.listModel(e)},backToHome:function(){this._resetDatas();this.getRouter().navTo("Home")},onPressNavBack:function(){this._resetDatas();this.getRouter().navTo("Home")},onPressNavToAvisDetail:function(e){var i=e.getSource().oBindingContexts.listModel.sPath;i=i.split("/")[1];if(i.indexOf("/")>-1){i=i.split("/")[0]}t.aDetailAvis=this.getView().byId("detailList").getModel("listModel").getData()[i];this.getRouter().navTo("AvisDetail")},_resetDatas:function(){t.sSelectedTile="";this._resetIcons()},onOpenSearchDialog:function(e){var t=sap.ui.xmlfragment("com.eramet.depanneur.HATDepanneurApp.view.fragment.search",this);this.getView().addDependent(t);this._resetModel();t.open()},onPressAccept:function(){var e=sap.ui.getCore(),i=e.byId("searchField").getSuggestionItems()[0].getText(),s={};if(t.aFilteredAvis.length>0){this._resetModel();this.listModel(t.aFilteredAvis)}else{for(var n=0;n<this.getModel("listModel").getData().length;n++){if(i===this.getModel("listModel").getData()[n].title){s=this.getModel("listModel").getData()[n];break}}this.listModel([s])}this.onPressClose()},onPressClose:function(){var e=sap.ui.getCore();e.byId("searchDialog").close();e.byId("searchDialog").destroy()},onSuggest:function(e){var t=e.getParameter("suggestValue"),i=[],s=sap.ui.getCore();if(t){i=[new sap.ui.model.Filter([new sap.ui.model.Filter("title",function(e){return(e||"").toUpperCase().indexOf(t.toUpperCase())>-1}),new sap.ui.model.Filter("text",function(e){return(e||"").toUpperCase().indexOf(t.toUpperCase())>-1}),new sap.ui.model.Filter("date",function(e){return(e||"").toUpperCase().indexOf(t.toUpperCase())>-1}),new sap.ui.model.Filter("equipement",function(e){return(e||"").toUpperCase().indexOf(t.toUpperCase())>-1}),new sap.ui.model.Filter("status",function(e){return(e||"").toUpperCase().indexOf(t.toUpperCase())>-1})],false)]}s.byId("searchField").getBinding("suggestionItems").filter(i);s.byId("searchField").suggest()},onSearch:function(e){var i=sap.ui.getCore();t.aFilteredAvis=[];var s=e.getParameter("suggestionItem");if(s===undefined){if(i.byId("searchField").mBindingInfos&&i.byId("searchField").mBindingInfos.suggestionItems&&i.byId("searchField").mBindingInfos.suggestionItems.binding&&i.byId("searchField").mBindingInfos.suggestionItems.binding.aIndices&&i.byId("searchField").mBindingInfos.suggestionItems.binding.aIndices.length>0){var n=[],a=this.getModel("listModel").getData();for(var o=0;o<i.byId("searchField").mBindingInfos.suggestionItems.binding.aIndices.length;o++){n.push(a[i.byId("searchField").mBindingInfos.suggestionItems.binding.aIndices[o]])}t.aFilteredAvis=n}}},onPressCriticality:function(){var e="";if(this.getView().byId("critical").getIcon!==""){if(this.getView().byId("critical").getIcon()==="sap-icon://up"){this.getView().byId("critical").setIcon("sap-icon://down");e=true}else{this.getView().byId("critical").setIcon("sap-icon://up");e=false}}else{this.getView().byId("critical").setIcon("sap-icon://up");e=false}this.getView().byId("date").setIcon("");this.getView().byId("repercussion").setIcon("");this.getView().byId("detailList").getBinding("items").sort(new sap.ui.model.Sorter("status",e,false))},onPressDate:function(){var e="";if(this.getView().byId("date").getIcon!==""){if(this.getView().byId("date").getIcon()==="sap-icon://up"){this.getView().byId("date").setIcon("sap-icon://down");e=true}else{this.getView().byId("date").setIcon("sap-icon://up");e=false}}else{this.getView().byId("date").setIcon("sap-icon://up");e=false}this.getView().byId("critical").setIcon("");this.getView().byId("repercussion").setIcon("");this.getView().byId("detailList").getBinding("items").sort(new sap.ui.model.Sorter("date",e,false))},onPressRepercussion:function(){var e="";if(this.getView().byId("repercussion").getIcon!==""){if(this.getView().byId("repercussion").getIcon()==="sap-icon://up"){this.getView().byId("repercussion").setIcon("sap-icon://down");e=true}else{this.getView().byId("repercussion").setIcon("sap-icon://up");e=false}}else{this.getView().byId("repercussion").setIcon("sap-icon://up");e=false}this.getView().byId("date").setIcon("");this.getView().byId("critical").setIcon("");this.getView().byId("detailList").getBinding("items").sort(new sap.ui.model.Sorter("equipement",e,false))},_resetIcons:function(){this.getView().byId("date").setIcon("");this.getView().byId("critical").setIcon("");this.getView().byId("repercussion").setIcon("")}})});