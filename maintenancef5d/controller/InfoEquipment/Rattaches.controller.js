sap.ui.define(["com/eramet/maintenanceF5D/controller/BaseController","com/eramet/maintenanceF5D/util/util","com/eramet/maintenanceF5D/util/formatter"],function(t,e,a){"use strict";return t.extend("com.eramet.maintenanceF5D.controller.InfoEquipment.Rattaches",{globalStartDate:null,globalEndDate:null,onInit:function(){this.getRouter().attachRoutePatternMatched(this._onRouteMatched,this)},_onRouteMatched:function(t){if(t.getParameter("name")==="Rattaches"){console.log("button text:",e.sRattachesButtonText);if(e.sRattachesButtonText==="avisRattache"){var a=this.getView().getModel("i18n").getResourceBundle().getText("rattachesTitle1");e.sTitleText=a+" "+e.aEquipment.equipement;this.setTitle();this.getView().byId("breadcrumbs").setCurrentLocationText(a);this.getView().byId("addButton").setVisible(true);this.getView().byId("type").setVisible(false);this.getView().byId("dateSelector").setText(this.getView().getModel("i18n").getResourceBundle().getText("rattachesDateButton1"));this._resetModel()}else{a=this.getView().getModel("i18n").getResourceBundle().getText("rattachesTitle2");e.sTitleText=a+" "+e.aEquipment.equipement;this.setTitle();this.getView().byId("breadcrumbs").setCurrentLocationText(a);this.getView().byId("addButton").setVisible(false);this.getView().byId("type").setVisible(true);this.getView().byId("dateSelector").setText(this.getView().getModel("i18n").getResourceBundle().getText("rattachesDateButton2"));this._resetModel()}}},backToHome:function(){this.getRouter().navTo("Home")},onPressNavBack:function(){this.getRouter().navTo("InfoEquipment")},onPressDateInterval:function(){this._openDateDialog()},_openDateDialog:function(){var t=sap.ui.xmlfragment("com.eramet.maintenanceF5D.view.fragment.dateDialog",this);this.getView().addDependent(t);t.open()},handleCalendarSelect:function(){var t=sap.ui.getCore().byId("calendar");this.globalStartDate=new Date(t.getSelectedDates()[0].getStartDate().getFullYear()+"/"+(t.getSelectedDates()[0].getStartDate().getMonth()+1)+"/"+t.getSelectedDates()[0].getStartDate().getDate()).getTime();this.globalEndDate=t.getSelectedDates()[0].getEndDate()?new Date(t.getSelectedDates()[0].getEndDate().getFullYear()+"/"+(t.getSelectedDates()[0].getEndDate().getMonth()+1)+"/"+t.getSelectedDates()[0].getEndDate().getDate()).getTime():null},onPressClose:function(){var t=sap.ui.getCore();t.byId("dateDialog").close();t.byId("dateDialog").destroy();this.getView().byId("detailList").getBinding("items").filter(new sap.ui.model.Filter("convertedDate",sap.ui.model.FilterOperator.BT,this.globalStartDate,this.globalEndDate))},_resetModel:function(){var t=[{title:e.sRattachesButtonText==="avisRattache"?"N° avis 0001":"N° OT 0000001",text:"Description 1",date:"21/10/2019",convertedDate:"1571608800000",equipement:"Trousse de réparation",status:"Ouvert",icon:e.sRattachesButtonText==="avisRattache"?"":"sap-icon://flag",type:e.sRattachesButtonText==="avisRattache"?"":"Type d'activité 1"},{title:e.sRattachesButtonText==="avisRattache"?"N° avis 0002":"N° OT 0000002",text:"Description 2",date:"18/10/2019",convertedDate:"1571349600000",equipement:"Verre coupé à la taille",status:"En cours",icon:e.sRattachesButtonText==="avisRattache"?"":"sap-icon://flag",type:e.sRattachesButtonText==="avisRattache"?"":"Type d'activité 2"},{title:e.sRattachesButtonText==="avisRattache"?"N° avis 0003":"N° OT 0000003",text:"Description 3",date:"17/10/2019",convertedDate:"1571263200000",equipement:"Charpentier",status:"Clôturé",icon:e.sRattachesButtonText==="avisRattache"?"":"sap-icon://flag",type:e.sRattachesButtonText==="avisRattache"?"":"Type d'activité 3"},{title:e.sRattachesButtonText==="avisRattache"?"N° avis 0004":"N° OT 0000004",text:"Description 4",date:"21/10/2019",convertedDate:"1571608800000",equipement:"Mécanicien en chauffage",status:"Repoussé",icon:"",type:e.sRattachesButtonText==="avisRattache"?"":"Type d'activité 4"},{title:e.sRattachesButtonText==="avisRattache"?"N° avis 0005":"N° OT 0000005",text:"Description 5",date:"15/10/2019",convertedDate:"1571090400000",equipement:"Serrurier",status:"Clôturé",icon:"",type:e.sRattachesButtonText==="avisRattache"?"":"Type d'activité 5"}];this.avisRattachesModel(t);this.getView().byId("detailList").getBinding("items").sort(new sap.ui.model.Sorter("date",true,false))},onPressNavToAvisDetail:function(t){var a=t.getSource().oBindingContexts.avisRattachesModel.sPath;a=a.split("/")[1];if(a.indexOf("/")>-1){a=a.split("/")[0]}if(e.sRattachesButtonText==="avisRattache"){e.aDetailAvis=this.getView().byId("detailList").getModel("avisRattachesModel").getData()[a];e.sSelectedTile="__xmlview2--errorFirst";this.getRouter().navTo("AvisDetail")}else{e.oSelectedOT=this.getView().byId("detailList").getModel("avisRattachesModel").getData()[a].title.split("N° ")[1];this.getRouter().navTo("Operations")}},onChangeStatus:function(){var t=this.getView().byId("status").getSelectedItem().getText();this.getView().byId("detailList").getBinding("items").filter(new sap.ui.model.Filter("status",sap.ui.model.FilterOperator.Contains,t))},onChangeType:function(){var t=this.getView().byId("type").getSelectedItem().getText();this.getView().byId("detailList").getBinding("items").filter(new sap.ui.model.Filter("type",sap.ui.model.FilterOperator.Contains,t))},onSelectItem:function(){var t=[],e=this.getView().byId("status").getSelectedItem()?this.getView().byId("status").getSelectedItem().getText():"",a=this.getView().byId("type").getSelectedItem()?this.getView().byId("type").getSelectedItem().getText():"";t=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("status",sap.ui.model.FilterOperator.Contains,e),new sap.ui.model.Filter("type",sap.ui.model.FilterOperator.Contains,a)],and:true});this.getView().byId("detailList").getBinding("items").filter(t)},onPressClearFilter:function(){this._resetModel();this.getView().byId("status").setSelectedKey("");this.getView().byId("type").setSelectedKey("")}})});